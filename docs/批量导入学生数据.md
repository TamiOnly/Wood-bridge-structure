# 批量导入学生数据指南

系统支持多种方式批量导入学生数据，适合大量学生数据的录入。

## 方法一：使用JSON文件导入（推荐）

### 1. 准备JSON文件

创建JSON文件（例如 `data/students.json`），格式如下：

```json
[
  {
    "name": "张三",
    "grade": "高一",
    "studentId": "2024001",
    "gender": "男",
    "role": "组长",
    "groupName": "第一组",
    "groupPassword": "123456"
  },
  {
    "name": "李四",
    "grade": "高一",
    "studentId": "2024002",
    "gender": "女",
    "role": "组员",
    "groupName": "第一组",
    "groupPassword": "123456"
  }
]
```

**字段说明：**
- `name`: 姓名（必填）
- `grade`: 年级（必填，例如：高一、高二、高三）
- `studentId`: 学号（必填，唯一）
- `gender`: 性别（必填，只能是 "男" 或 "女"）
- `role`: 角色（必填，只能是 "组长" 或 "组员"）
- `groupName`: 组名（必填）
- `groupPassword`: 小组密码（必填，同一组的学生密码必须相同）

### 2. 执行导入

```bash
node scripts/import-students.js data/students.json
```

### 3. 查看结果

脚本会显示：
- 成功导入的数量
- 失败的数量
- 详细的错误信息（如果有）

## 方法二：使用CSV文件导入

### 1. 准备CSV文件

创建CSV文件（例如 `data/students.csv`），第一行为标题行：

```csv
姓名,年级,学号,性别,角色,组名,小组密码
张三,高一,2024001,男,组长,第一组,123456
李四,高一,2024002,女,组员,第一组,123456
王五,高一,2024003,男,组员,第一组,123456
赵六,高二,2023001,女,组长,第二组,abc123
```

**注意：**
- 第一行必须是标题行
- 列顺序必须与示例一致
- 列名必须完全匹配（包括中文）

### 2. 执行导入

```bash
node scripts/import-from-csv.js data/students.csv
```

## 方法三：使用API接口导入

### 1. 调用批量导入API

```bash
curl -X POST http://localhost:3000/api/students/batch \
  -H "Content-Type: application/json" \
  -d '{
    "students": [
      {
        "name": "张三",
        "grade": "高一",
        "studentId": "2024001",
        "gender": "男",
        "role": "组长",
        "groupName": "第一组",
        "groupPassword": "123456"
      },
      {
        "name": "李四",
        "grade": "高一",
        "studentId": "2024002",
        "gender": "女",
        "role": "组员",
        "groupName": "第一组",
        "groupPassword": "123456"
      }
    ]
  }'
```

### 2. API响应示例

```json
{
  "success": true,
  "result": {
    "total": 2,
    "success": 2,
    "failed": 0,
    "errors": []
  }
}
```

## 数据验证规则

系统会自动验证以下规则：

1. **学号唯一性**：每个学号只能使用一次
2. **组长唯一性**：每个组只能有一个组长
3. **组密码一致性**：同一组的所有学生密码必须相同
4. **性别格式**：只能是 "男" 或 "女"
5. **角色格式**：只能是 "组长" 或 "组员"

## 导入结果说明

- **成功**：数据已成功导入数据库
- **失败**：数据验证失败或已存在，会在错误列表中显示具体原因

## 示例文件

系统提供了示例文件供参考：
- `data/students.example.json` - JSON格式示例
- 可以复制此文件并修改为实际数据

## 常见问题

### Q: 如何修改已导入的学生数据？
A: 需要先删除旧数据，然后重新导入。或者使用更新API。

### Q: 同一组的学生密码必须相同吗？
A: 是的，这是系统要求。同一组的学生必须使用相同的组密码。

### Q: 可以从Excel导入吗？
A: 可以。先将Excel文件另存为CSV格式，然后使用方法二导入。

### Q: 导入时会覆盖已有数据吗？
A: 不会。如果学号已存在，会跳过并报告错误。

### Q: 如何批量删除学生数据？
A: 目前需要手动删除数据库文件或使用数据库管理工具。

## 提示

1. **备份数据**：大量导入前建议备份数据库文件 `data/students.db`
2. **分组导入**：如果数据量很大，建议按组分别导入
3. **检查数据**：导入前检查JSON/CSV文件格式是否正确
4. **查看日志**：导入时注意查看控制台输出的详细信息

